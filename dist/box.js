!function(){"use strict";var t,e,r=(t=function(t){t.exports=function(){var t,e=[],r=document,o="DOMContentLoaded",n=(r.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);return n||r.addEventListener(o,t=function(){for(r.removeEventListener(o,t),n=1;t=e.shift();)t()}),function(t){n?setTimeout(t,0):e.push(t)}}()},e=void 0,t(e={exports:{}},e.exports),e.exports);function o(){}function n(t){for(var e,r,o=1,n=arguments.length;o<n;o++){r=arguments[o];for(e in r)t[e]=r[e]}return t}function i(t,e){e.appendChild(t)}function s(t,e,r){e.insertBefore(t,r)}function a(t){t.parentNode.removeChild(t)}function l(t,e){for(;t.nextSibling&&t.nextSibling!==e;)t.parentNode.removeChild(t.nextSibling)}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function h(t,e,r){t.setAttribute(e,r)}function d(t,e,r){t.style.setProperty(e,r)}function f(){return Object.create(null)}function p(t){this.destroy=o,this.fire("destroy"),this.set=this.get=o,!1!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function m(t,e){return t!==e||t&&"object"==typeof t||"function"==typeof t}function g(t,e,r,o,n){for(var i in e)if(r[i]){var s=o[i],a=n[i],l=e[i];if(l)for(var c=0;c<l.length;c+=1){var u=l[c];u.__calling||(u.__calling=!0,u.call(t,s,a),u.__calling=!1)}}}function v(t){return t?this._state[t]:this._state}function x(t,e,r){var o=r&&r.defer?this._observers.post:this._observers.pre;return(o[t]||(o[t]=[])).push(e),r&&!1===r.init||(e.__calling=!0,e.call(this,this._state[t]),e.__calling=!1),{cancel:function(){var r=o[t].indexOf(e);~r&&o[t].splice(r,1)}}}function b(t){for(;t&&t.length;)t.pop()()}function _(){this.store._remove(this)}var $={destroy:p,get:v,fire:function(t,e){var r=t in this._handlers&&this._handlers[t].slice();if(r)for(var o=0;o<r.length;o+=1)r[o].call(this,e)},observe:x,on:function(t,e){if("teardown"===t)return this.on("destroy",e);var r=this._handlers[t]||(this._handlers[t]=[]);return r.push(e),{cancel:function(){var t=r.indexOf(e);~t&&r.splice(t,1)}}},set:function(t){this._set(n({},t)),this.root._lock||(this.root._lock=!0,b(this.root._beforecreate),b(this.root._oncreate),b(this.root._aftercreate),this.root._lock=!1)},teardown:p,_recompute:o,_set:function(t){var e=this._state,r={},o=!1;for(var i in t)m(t[i],e[i])&&(r[i]=o=!0);o&&(this._state=n({},e,t),this._recompute(r,this._state),this._bind&&this._bind(r,this._state),this._fragment&&(g(this,this._observers.pre,r,this._state,e),this._fragment.p(r,this._state),g(this,this._observers.post,r,this._state,e)))},_mount:function(t,e){this._fragment.m(t,e)},_unmount:function(){this._fragment&&this._fragment.u()}};function y(t){this._observers={pre:f(),post:f()},this._changeHandlers=[],this._dependents=[],this._computed=f(),this._sortedComputedProperties=[],this._state=n({},t)}n(y.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},r=0;r<t.length;r+=1){var o=t[r];e["$"+o]=this._state[o]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_sortComputedProperties:function(){var t,e=this._computed,r=this._sortedComputedProperties=[],o=f();function n(i){if(t[i])throw new Error("Cyclical dependency detected");if(!o[i]){o[i]=!0;var s=e[i];s&&(t[i]=!0,s.deps.forEach(n),r.push(s))}}for(var i in this._computed)t=f(),n(i)},compute:function(t,e,r){var o,n={deps:e,update:function(n,i,s){var a=e.map(function(t){return t in i&&(s=!0),n[t]});if(s){var l=r.apply(null,a);m(l,o)&&(o=l,i[t]=!0,n[t]=o)}}};n.update(this._state,{},!0),this._computed[t]=n,this._sortComputedProperties()},get:v,observe:x,onchange:function(t){return this._changeHandlers.push(t),{cancel:function(){var e=this._changeHandlers.indexOf(t);~e&&this._changeHandlers.splice(e,1)}}},set:function(t){var e=this._state,r=this._changed={},o=!1;for(var i in t){if(this._computed[i])throw new Error("'"+i+"' is a read-only property");m(t[i],e[i])&&(r[i]=o=!0)}if(o){this._state=n({},e,t);for(var s=0;s<this._sortedComputedProperties.length;s+=1)this._sortedComputedProperties[s].update(this._state,r);for(s=0;s<this._changeHandlers.length;s+=1)this._changeHandlers[s](this._state,r);g(this,this._observers.pre,r,this._state,e);var a=this._dependents.slice();for(s=0;s<a.length;s+=1){var l=a[s],c={};o=!1;for(var u=0;u<l.props.length;u+=1){var h=l.props[u];h in r&&(c["$"+h]=this._state[h],o=!0)}o&&l.component.set(c)}g(this,this._observers.post,r,this._state,e)}}});function S(){var t="http://purl.org/dc/elements/1.1/",e=/([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9:]+).*$/,r=function(t){return t?(t.length&&(t=t[0]),t.textContent):""},o=function(t,e){var r=t.querySelector("source"),o=t.querySelector("enclosure"),n=t.querySelector("category");return r&&(e.source={link:r.getAttribute("url"),title:r.textContent}),o&&(e.enclosure={link:o.getAttribute("url"),length:o.getAttribute("length"),type:o.getAttribute("type")}),n&&(e.category={domain:n.getAttribute("domain")||"",content:n.textContent}),e.buttons=[],e},n=function(t){var r=Date.parse(t);return isNaN(r)&&(r=Date.parse(String(t).replace(e,"$1/$2/$3 $4")),isNaN(r)&&(r=Date.now())),new Date(r)};return{parse:function(e){var i=function(t){if(t){var e;return document.implementation.createDocument?e=(new DOMParser).parseFromString(t,"application/xml"):window.ActiveXObject&&((e=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)),e}}(e).documentElement,s=i.nodeName;return"scriptingNews"===s?function(t){var e={items:[]},i=t.querySelector("header");e.format="Scripting News",e.version=r(i.querySelector("scriptingNewsVersion")),e.title=r(i.querySelector("channelTitle")),e.description=r(i.querySelector("channelDescription")),e.link=r(i.querySelector("channelLink")),e.date=n(r(i.querySelector("lastBuildDate"))||r(i.querySelector("pubDate")));var s=i.querySelector("imageUrl");return s&&(e.image={source:r(s),title:r(i.querySelector("imageTitle")),link:r(i.querySelector("imageLink")),width:r(i.querySelector("imageWidth")),height:r(i.querySelector("imageHeight")),description:r(i.querySelector("imageCaption"))}),t.querySelectorAll("item").forEach(function(t){var n={title:""};n.description=r(t.querySelector("text")).replace(/\n/g," ");var i=t.querySelector("link");if(i){var s=r(i.querySelector("linetext")).replace(/\n/g," ").trim();s&&(n.description=n.description.replace(new RegExp(s),'<a href="'+r(t.querySelector("url"))+'">'+s+"</a>")),n.link=r(i.querySelector("url"))}o(t,n),e.items.push(n)}),e}(i):function(e,i){var s={items:[]},a=e.querySelector("channel");s.format="RSS",s.version="rdf:RDF"===i?"1.0":e.getAttribute("version"),s.title=r(e.querySelector("channel > title")),s.description=r(e.querySelector("channel > description")),s.link=r(e.querySelector("channel > link"));var l=e.querySelector("image");if(s.image=l?{source:r(l.querySelector("url"))||l.getAttributeNS("http://www.w3.org/1999/02/22-rdf-syntax-ns#","resource"),title:r(l.querySelector("title")),link:r(l.querySelector("link")),width:r(l.querySelector("width")),height:r(l.querySelector("height")),description:r(l.querySelector("description"))}:"","rdf:RDF"===i){var c=a.getElementsByTagNameNS(t,"date");s.date=n(r(c)),s.rights=r(a.getElementsByTagNameNS(t,"creator"));var u=e.querySelector("textinput");s.input=u?{link:r(u.querySelector("link")),description:r(u.querySelector("description")),name:r(u.querySelector("name")),title:r(u.querySelector("title"))}:""}else s.date=n(r(a.querySelector("lastBuildDate"))||r(a.querySelector("pubDate"))),s.rights=r(a.querySelector("copyright"));return e.querySelectorAll("item").forEach(function(t){var e={title:r(t.querySelector("title")),description:r(t.querySelector("description")),link:r(t.querySelector("link"))||r(t.querySelector("guid"))};if(!e.description){var n=r(t.querySelector("content\\:encoded"));n?e.description=n:(n=r(t.querySelector("encoded")))&&(e.description=n)}o(t,e),s.items.push(e)}),s}(i,s)}}}var C={boxFillColor:"#fff",compact:!1,fontFace:"10pt sans-serif",frameColor:"#000",headless:!1,height:-1,linkColor:"",maxItems:7,radius:0,showXmlButton:!0,textColor:"#000",titleBarColor:"#add8e6",titleBarTextColor:"#000",url:"https://blog.p3k.org/stories.xml",width:200},k=Object.assign({base:"//p3k.org/rss",roxy:location.protocol+"//p3k-services.appspot.com/roxy",ferris:location.protocol+"//p3k-services.appspot.com/ferris?callback=?&group=rssbox"},{base:"http://localhost:5000",roxy:"http://localhost:8081/roxy",ferris:"http://localhost:8081/ferris?group=rssbox"}),w=function(t){function e(e){var r={date:new Date,description:"",format:"",image:"",input:"",items:[],title:"",url:e||"",version:""};t.call(this,r),this.compute("formattedDate",["date"],function(t){if(t){var e=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),o=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0");return t.getFullYear()+"-"+e+"-"+r+", "+o+":"+n+"h"}}),this.observe("url",this.fetch)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fetch=function(){var t=this,e=this.get("url");e&&fetch(k.roxy+"?url="+encodeURIComponent(e)).then(function(e){e.text().then(function(e){var r=S(),o=JSON.parse(e).content,n=r.parse(o);t.set(n)})})},e}(y);function q(t){h(t,"svelte-521448997","")}function B(t,e){var r,n,l,u;return{c:function(){r=c("div"),n=c("a"),l=c("span"),this.h()},h:function(){q(l),l.className="rssbox-icon",l.title=u=t.$format+" "+t.$version,n.href=t.$url,d(r,"float","right")},m:function(t,e){s(r,t,e),i(n,r),i(l,n)},p:function(t,e){(t.$format||t.$version)&&u!==(u=e.$format+" "+e.$version)&&(l.title=u),t.$url&&(n.href=e.$url)},u:function(){a(r)},d:o}}function N(t,e){var r,o,n,l,h,f,p,m,g=t.$showXmlButton&&B(t);return{c:function(){r=c("div"),g&&g.c(),o=u("\n      "),n=c("div"),l=c("a"),h=u(t.$title),f=u("\n      "),p=c("div"),m=u(t.$formattedDate),this.h()},h:function(){q(r),l.href=t.$link,d(l,"color",t.$titleBarTextColor),q(p),p.className="rssbox-date",r.className="rssbox-titlebar",d(r,"color",t.$titleBarTextColor),d(r,"background-color",t.$titleBarColor),d(r,"border-bottom-color",t.$frameColor)},m:function(t,e){s(r,t,e),g&&g.m(r,null),i(o,r),i(n,r),i(l,n),i(h,l),i(f,r),i(p,r),i(m,p)},p:function(t,e){e.$showXmlButton?g?g.p(t,e):((g=B(e)).c(),g.m(r,o)):g&&(g.u(),g.d(),g=null),t.$title&&(h.data=e.$title),t.$link&&(l.href=e.$link),t.$titleBarTextColor&&d(l,"color",e.$titleBarTextColor),t.$formattedDate&&(m.data=e.$formattedDate),t.$titleBarTextColor&&d(r,"color",e.$titleBarTextColor),t.$titleBarColor&&d(r,"background-color",e.$titleBarColor),t.$frameColor&&d(r,"border-bottom-color",e.$frameColor)},u:function(){a(r),g&&g.u()},d:function(){g&&g.d()}}}function D(t,e){var r,n,l,u,f;return{c:function(){r=c("a"),n=c("span"),this.h()},h:function(){q(n),h(n,"alt",l=t.$image.description),n.className="rssbox-image",d(n,"background-image","url("+t.$image.source+")"),d(n,"width",t.$image.width+"px"),d(n,"height",t.$image.height+"px"),r.href=u=t.$image.link,r.title=f=t.$image.title},m:function(t,e){s(r,t,e),i(n,r)},p:function(t,e){t.$image&&l!==(l=e.$image.description)&&h(n,"alt",l),t.$image&&(d(n,"background-image","url("+e.$image.source+")"),d(n,"width",e.$image.width+"px"),d(n,"height",e.$image.height+"px")),t.$image&&u!==(u=e.$image.link)&&(r.href=u),t.$image&&f!==(f=e.$image.title)&&(r.title=f)},u:function(){a(r)},d:o}}function T(t,e,r,o,n){var i,l=o<t.$maxItems&&F(t,e,r,o,n);return{c:function(){l&&l.c(),i=document.createComment("")},m:function(t,e){l&&l.m(t,e),s(i,t,e)},p:function(t,e,r,o,s){s<e.$maxItems?l?l.p(t,e,r,o,s):((l=F(e,r,o,s,n)).c(),l.m(i.parentNode,i)):l&&(l.u(),l.d(),l=null)},u:function(){l&&l.u(),a(i)},d:function(){l&&l.d()}}}function E(t,e,r,n,i){var h,d,f,p,m=r.description,g=r.buttons;return{c:function(){h=c("noscript"),d=c("noscript"),f=u("\n            "),p=u(g)},m:function(t,e){s(h,t,e),h.insertAdjacentHTML("afterend",m),s(d,t,e),s(f,t,e),s(p,t,e)},p:function(t,e,r,o,n){t.$items&&m!==(m=o.description)&&(l(h,d),h.insertAdjacentHTML("afterend",m)),t.$items&&g!==(g=o.buttons)&&(p.data=g)},u:function(){l(h,d),a(h),a(d),a(f),a(p)},d:o}}function F(t,e,r,o,n){var l,h,f,p,m,g,v=r.title,x=!t.$compact&&E(0,0,r);return{c:function(){l=c("div"),h=c("div"),f=c("a"),p=u(v),g=u("\n          "),x&&x.c(),this.h()},h:function(){q(l),f.href=m=r.link,d(f,"color",t.$textColor),d(h,"font-weight",t.$fontWeight),l.className="rssbox-item-content rssBoxItemContent",d(l,"color",t.$textColor)},m:function(t,e){s(l,t,e),i(h,l),i(f,h),i(p,f),i(g,l),x&&x.m(l,null)},p:function(t,e,r,o,n){t.$items&&v!==(v=o.title)&&(p.data=v),t.$items&&m!==(m=o.link)&&(f.href=m),t.$textColor&&d(f,"color",e.$textColor),t.$fontWeight&&d(h,"font-weight",e.$fontWeight),e.$compact?x&&(x.u(),x.d(),x=null):x?x.p(t,e,r,o,n):((x=E(0,0,o)).c(),x.m(l,null)),t.$textColor&&d(l,"color",e.$textColor)},u:function(){a(l),x&&x.u()},d:function(){x&&x.d()}}}function O(t,e){var r;return{c:function(){r=u("TODO")},m:function(t,e){s(r,t,e)},u:function(){a(r)},d:o}}function A(t){r=t,(e=this)._observers={pre:f(),post:f()},e._handlers=f(),e._bind=r._bind,e.options=r,e.root=r.root||e,e.store=e.root.store||r.store;var e,r;this._state=n(this.store._init(["height","linkColor","width","frameColor","radius","fontFace","headless","titleBarTextColor","titleBarColor","showXmlButton","url","format","version","link","title","formattedDate","boxFillColor","image","items","maxItems","textColor","fontWeight","compact","input"]),t.data),this.store._add(this,["height","linkColor","width","frameColor","radius","fontFace","headless","titleBarTextColor","titleBarColor","showXmlButton","url","format","version","link","title","formattedDate","boxFillColor","image","items","maxItems","textColor","fontWeight","compact","input"]),this._recompute({$height:1},this._state),this._handlers.destroy=[_],document.getElementById("svelte-521448997-style")||function(){var t=c("style");t.id="svelte-521448997-style",t.textContent=".rssbox[svelte-521448997]{width:200px;border:1px solid #000;font:sans-serif;float:left;overflow:hidden;border-radius:0;-moz-border-radius:0}.rssbox-icon[svelte-521448997],.rssbox-image[svelte-521448997]{display:inline-block;float:right;margin:5px 0 5px 5px;background-position:left center;background-repeat:no-repeat}.rssbox-icon[svelte-521448997]{height:16px;width:16px;margin:1px 4px;background-image:url(img/rss.png);background-size:16px 16px}.rssbox-titlebar[svelte-521448997]{padding:5px 3px 5px 10px;color:#000;background-color:#add8e6;border-bottom:1px solid #000;font-weight:bold}.rssbox-content[svelte-521448997]{height:auto;padding:5px 10px;overflow-x:hidden;overflow-y:auto;background-color:#fff;clear:both}.rssbox-date[svelte-521448997]{margin-top:1px;font-size:80%}.rssbox-promo[svelte-521448997]{margin:0 -5px -1px 0;text-align:right;font-size:7pt;letter-spacing:0.5px}",i(t,document.head)}();var o=function(){var t=this;this.store.observe("compact",function(e){t.store.set({fontWeight:e?"initial":"bold"})});var e="rssbox-dynamic-stylesheet",r=window[e];r||((r=document.createElement("style")).id=e,r.innerHTML="\n      .rssbox * {\n        box-sizing: border-box;\n        margin: 0;\n        padding: 0;\n      }\n\n      .rssbox a {\n        text-decoration: none;\n      }\n\n      .rssbox a:hover {\n        text-decoration: underline;\n      }\n\n      .rssbox-titlebar a {\n        color: #000;\n      }\n\n      .rssbox-content p, .rssbox-content img {\n        margin-top: 0.5em;\n      }\n\n      .rssbox-content img {\n        width: 100% !important;\n        height: auto ;\n      }\n\n      .rssbox-content figcaption {\n        font-size: 0.8em;\n      }\n\n      .rssbox-item-content {\n        margin-bottom: 0.8em;\n      }",document.head.append(r)),this.store.observe("linkColor",function(t){if(t){var e='.rssbox[data-link-color="'+t+'"] .rssbox-item-content a {\n        color: '+t+";\n      }";r.innerHTML.indexOf(e)<0&&(r.innerHTML+=e)}})}.bind(this);t.root?this.root._oncreate.push(o):this._oncreate=[o],this._fragment=function(t,e){for(var r,o,n,l,h,f,p,m=!t.$headless&&N(t),g=t.$image&&D(t),v=t.$items,x=[],b=0;b<v.length;b+=1)x[b]=T(t,v,v[b],b,e);var _=t.$input&&O();return{c:function(){r=c("div"),m&&m.c(),o=u("\n  "),n=c("div"),g&&g.c(),l=u("\n    ");for(var t=0;t<x.length;t+=1)x[t].c();h=u("\n    "),_&&_.c(),f=u("\n    "),(p=c("div")).innerHTML='<a href="http://p3k.org/rss">RSS Box by p3k.org</a>',this.h()},h:function(){q(r),q(n),q(p),p.className="rssbox-promo rssBoxPromo",n.className="rssbox-content rssBoxContent",d(n,"background-color",t.$boxFillColor),d(n,"height",t.height),r.dataset.linkColor=t.$linkColor,r.className="rssbox rssBox",d(r,"width",t.$width+"px"),d(r,"border-color",t.$frameColor),d(r,"border-radius",t.$radius+"px"),d(r,"font",t.$fontFace)},m:function(t,e){s(r,t,e),m&&m.m(r,null),i(o,r),i(n,r),g&&g.m(n,null),i(l,n);for(var a=0;a<x.length;a+=1)x[a].m(n,null);i(h,n),_&&_.m(n,null),i(f,n),i(p,n)},p:function(t,i){i.$headless?m&&(m.u(),m.d(),m=null):m?m.p(t,i):((m=N(i)).c(),m.m(r,o)),i.$image?g?g.p(t,i):((g=D(i)).c(),g.m(n,l)):g&&(g.u(),g.d(),g=null);var s=i.$items;if(t.$maxItems||t.$textColor||t.$fontWeight||t.$items||t.$compact){for(var a=0;a<s.length;a+=1)x[a]?x[a].p(t,i,s,s[a],a):(x[a]=T(i,s,s[a],a,e),x[a].c(),x[a].m(n,h));for(;a<x.length;a+=1)x[a].u(),x[a].d();x.length=s.length}i.$input?_||((_=O()).c(),_.m(n,f)):_&&(_.u(),_.d(),_=null),t.$boxFillColor&&d(n,"background-color",i.$boxFillColor),t.height&&d(n,"height",i.height),t.$linkColor&&(r.dataset.linkColor=i.$linkColor),t.$width&&d(r,"width",i.$width+"px"),t.$frameColor&&d(r,"border-color",i.$frameColor),t.$radius&&d(r,"border-radius",i.$radius+"px"),t.$fontFace&&d(r,"font",i.$fontFace)},u:function(){a(r),m&&m.u(),g&&g.u();for(var t=0;t<x.length;t+=1)x[t].u();_&&_.u()},d:function(){m&&m.d(),g&&g.d(),function(t){for(var e=0;e<t.length;e+=1)t[e]&&t[e].d()}(x),_&&_.d()}}}(this._state,this),t.target&&(this._fragment.c(),this._fragment.m(t.target,t.anchor||null),b(this._oncreate))}n(A.prototype,$),A.prototype._recompute=function(t,e){t.$height&&m(e.height,e.height=(r=e.$height,r>-1?r+"px":"100%"))&&(t.height=!0);var r};r(function(){var t=/https?:\/\/[^/]+\/main\.js/;Array.prototype.filter.call(document.scripts,function(e){return e.src&&e.src.match(t)}).forEach(function(e){var r,o=e.src.split(t)[1].substr(1),n=(r=o,r.split("&").reduce(function(t,e){var r=e.split("="),o=r[0],n=r[1];t[o]=(i=decodeURIComponent(n),"true"===i||"false"!==i&&i);var i;return t},{}));n=Object.assign({},C,n);var i=new w(n.url);i.set(n);var s=e.parentNode,a=document.createElement("div");s.insertBefore(a,e),new A({target:a,store:i}),e.remove()})})}();
//# sourceMappingURL=box.js.map
